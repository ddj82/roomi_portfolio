<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>ë³¸ì¸ì¸ì¦ ì¤‘...</title>
    <script src="https://cdn.iamport.kr/js/iamport.payment-1.2.0.js"></script>
</head>
<body>
<h2 style="text-align: center; margin-top: 40px;">ğŸ” ë³¸ì¸ì¸ì¦ì„ ì§„í–‰ ì¤‘ì…ë‹ˆë‹¤...</h2>
<script>
    (function () {
        const params = new URLSearchParams(window.location.search);
        const userCode = params.get('userCode') || 'imp01154410';  // âœ… ì–¸ë‹ˆ ê°€ë§¹ì  ì½”ë“œ
        const merchantUid = params.get('merchantUid') || `roomi_cert_${Date.now()}`;
        const company = params.get('company') || 'Roomi';
        const successUrl = params.get('successUrl') || 'com.myno1214.roomi://verification-success';
        const failUrl = params.get('failUrl') || 'com.myno1214.roomi://verification-fail';

        const IMP = window.IMP;
        IMP.init(userCode);

        console.log('ğŸš€ ë³¸ì¸ì¸ì¦ ìë™ ì‹œì‘');
        IMP.certification({
            merchant_uid: merchantUid,
            company: company,
            min_age: 18,
            carrier: '',  // ì‚¬ìš©ì ì„ íƒ
            name: '',     // ì‚¬ìš©ì ì…ë ¥
            phone: '' ,    // ì‚¬ìš©ì ì…ë ¥
            redirect_url : 'com.myno1214.roomi://verification-done', // ëª¨ë°”ì¼ ë¦¬ë‹¤ì´ë ‰íŠ¸ URL
            m_redirect_url : 'com.myno1214.roomi://verification-done'
        }, function (rsp) {
            console.log('ğŸ“± ë³¸ì¸ì¸ì¦ ê²°ê³¼:', rsp);

            // if (rsp.success) {
            //     const redirectUrl = new URL(successUrl);
            //     redirectUrl.searchParams.set('success', 'true');
            //     redirectUrl.searchParams.set('imp_uid', rsp.imp_uid);
            //     redirectUrl.searchParams.set('merchant_uid', rsp.merchant_uid);
            //     location.href = redirectUrl.toString();
            // } else {
            //     const redirectUrl = new URL(failUrl);
            //     redirectUrl.searchParams.set('success', 'false');
            //     redirectUrl.searchParams.set('error_msg', rsp.error_msg || 'ì¸ì¦ ì‹¤íŒ¨');
            //     redirectUrl.searchParams.set('merchant_uid', rsp.merchant_uid || merchantUid);
            //     location.href = redirectUrl.toString();
            // }
        });
    })();
</script>
</body>
</html>